---
layout: post
title: 7åˆ†é’Ÿå­¦ä¼šå†™ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶â€”â€”çªç ´æŸSDNæœªç™»å½•ç¦æ­¢å¤åˆ¶çš„é™åˆ¶
categories: Chrome
description: æµè§ˆå™¨æ’ä»¶
keywords: JS, å‰ç«¯, JavaScript, Chrome
---

&emsp;&emsp;ä¸¥æ ¼æ„ä¹‰ä¸Šè¯´ï¼Œæœ¬ç¯‡æ–‡ç« è¦è®¨è®ºçš„åº”è¯¥æ˜¯ â€œChrome æ‰©å±•(Extension)â€è€Œä¸æ˜¯â€œChrome æ’ä»¶ï¼ˆPluginsï¼‰â€ï¼Œå¤§å®¶ä¸å¦¨å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šâ€œæµè§ˆå™¨æ’ä»¶â€å’Œâ€œæµè§ˆå™¨æ‰©å±•â€ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚æœæ‚¨å¯¹æ­¤æ„Ÿåˆ°åŒçƒ¦ï¼Œä¸å¦¨ç›´æ¥è·³è¿‡æ­¤å°èŠ‚çš„é˜…è¯»ã€‚

## å…³äº Chrome æ’ä»¶ä¸æ‰©å±•çš„è¯¯åŒº

&emsp;&emsp;Chrome æµè§ˆå™¨è‡ª 2008 å¹´è¯ç”Ÿä»¥æ¥å‘ç”Ÿäº†å¾ˆå¤šäº‹æƒ…ï¼Œå®ƒæ˜¯ç›®å‰åŠŸèƒ½æœ€å®Œå¤‡ã€å¯¹æ–°ç‰¹æ€§æ”¯æŒæœ€å……åˆ†çš„ Web æµè§ˆå™¨ï¼ŒChrome çš„å‡ºç°ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šæ‰©å±•äº†æˆ‘ä»¬å¯¹æµè§ˆå™¨åŠŸèƒ½çš„å®šä¹‰ï¼Œå¹¶ä¸”å®ƒæ”¯æŒç¬¬ä¸‰æ–¹å¼€å‘äººå‘˜åˆ¶ä½œçš„åº”ç”¨ç¨‹åºã€æ’ä»¶å’Œæ‰©å±•ã€‚ä½†æ˜¯è¿™ä¸‰è€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå¦‚æœä½ æƒ³è·å¾—å¹¿å‘Šæ‹¦æˆªå™¨ï¼Œé‚£æ˜¯åº”ç”¨ç¨‹åºè¿˜æ˜¯æ‰©å±•ç¨‹åºï¼Ÿåœ¨ HTML5 ä¹‹å‰æ›¾çº¢æä¸€æ—¶ã€å¯ä»¥è®©ç½‘ç«™å†…å®¹å˜å¾—æ›´ä¸°å¯Œã€å¸¦æ¥äº†è§†é¢‘/åŠ¨ç”»/æ¸¸æˆå´å› å®‰å…¨é—®é¢˜ä¸€ç›´é¥±å—è¯Ÿç—…çš„ Adobe Flashï¼Œæ˜¯å±äºæµè§ˆå™¨æ‰©å±•è¿˜æ˜¯æ’ä»¶ï¼Ÿ

&emsp;&emsp;åœ¨æ­¤ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ Chrome åº”ç”¨ç¨‹åºã€æ’ä»¶å’Œæ‰©å±•ç¨‹åºä¹‹é—´ï¼ˆChrome apps, plugins and extensionsï¼‰çš„åŒºåˆ«ï¼Œä»¥ä¾¿ä½ èƒ½å¤Ÿå§‹ç»ˆçŸ¥é“è‡ªå·±éœ€è¦çš„æ˜¯ä»€ä¹ˆã€‚

### Chrome åº”ç”¨ç¨‹åºï¼ˆChrome Appsï¼‰

&emsp;&emsp;Chrome åº”ç”¨ç¨‹åºçš„æ¦‚å¿µï¼Œå¯èƒ½æ˜¯ Chrome åº”ç”¨ç¨‹åºã€æ’ä»¶å’Œæ‰©å±•ç¨‹åºä¸­æœ€æ¨¡ç³Šçš„ï¼Œå› ä¸ºå…¶å® Google æœ¬èº«å¯ä»¥äº’æ¢åœ°æŒ‡ä»£åº”ç”¨ç¨‹åºå’Œæ‰©å±•ç¨‹åºã€‚æƒ³è¦è¯æ˜è¿™ä¸€ç‚¹ä¹Ÿä¸éš¾ï¼Œä½ å¯ä»¥è½¬åˆ° Chrome ç½‘ä¸Šåº”ç”¨åº—ä¸­çš„[æ‰©å±•ç¨‹åºé¡µé¢](https://chrome.google.com/webstore/category/extensions){:target='\_blank'}ï¼ˆ`https://chrome.google.com/webstore/category/extensions`ï¼‰ï¼Œåœ¨åœ°å€æ ä¸­å°†â€œextensionsâ€ä¸€è¯æ›¿æ¢ä¸ºâ€œappsâ€ï¼Œå®ƒå®é™…ä¸Šä¼šé‡å®šå‘å›æ‰©å±•ï¼ˆextensionsï¼‰é¡µé¢ï¼

&emsp;&emsp;Web Store æ›¾ç»æœ‰ä¸€ä¸ªä¸“é—¨çš„â€œåº”ç”¨ç¨‹åºï¼ˆAppsï¼‰â€éƒ¨åˆ†ï¼Œåœ¨é‚£é‡Œæä¾›ç‹¬ç«‹çš„æ¡Œé¢åº”ç”¨ç¨‹åºã€‚ä½†åœ¨ 2017 å¹´åº•ï¼Œè°·æ­Œç§»é™¤äº†è¿™äº›ä¼ ç»Ÿçš„ Chrome åº”ç”¨ç¨‹åºï¼Œå› ä¸º Google æ¨åŠ¨äº†â€œæ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºï¼ˆProgressive Web Appsï¼Œå³ PWAï¼‰â€çš„æ„æƒ³ï¼Œä»æœ¬è´¨ä¸Šå°†ç½‘ç«™è½¬å˜ä¸ºä»æ¡Œé¢æˆ–æ‰‹æœºå³æ—¶è®¿é—®çš„åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥å¦‚ä»Šçš„æœç´¢æ¡†ä¸‹æ–¹åªæœ‰â€œExtensionsâ€å’Œâ€œThemesâ€ä¸¤éƒ¨åˆ†äº†ã€‚

![extensions](https://king-hcj.github.io/images/browser/extensions.png?raw=true)

&emsp;&emsp;å¯¹äºæ™®é€šçš„ PC ç”¨æˆ·æ¥è¯´ï¼ŒChrome åº”ç”¨ç¨‹åºå¦‚ä»Šå·²èå…¥æ‰©å±•ç¨‹åºä¸­ã€‚å¦‚æœä½ æ­£åœ¨ä¸º Chrome å¯»æ‰¾å¹¿å‘Šæ‹¦æˆªå™¨ã€Web Clipper ç­‰ï¼Œæ— è®ºä½ æœç´¢â€œChrome appâ€è¿˜æ˜¯â€œChrome extensionâ€ï¼Œæ‚¨æœ€ç»ˆéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªæ‰©å±•ç¨‹åºã€‚

### Chrome æ‰©å±•ç¨‹åºï¼ˆChrome Extensionsï¼‰

![extensions](https://king-hcj.github.io/images/browser/my_extensions.png?raw=true)

&emsp;&emsp;Chrome æ‰©å±•ç¨‹åºæ˜¯ Chrome çš„é™„åŠ ç»„ä»¶ï¼Œæ—¨åœ¨**ä»¥å„ç§æ–¹å¼æ”¹å–„æ‚¨çš„ä½“éªŒ**ã€‚è¿™ç§ä½“éªŒçš„æ”¹å–„å¯ä»¥ä»æ•°æ®ä¿æŠ¤ç¨‹åºåˆ°å¹¿å‘Šæ‹¦æˆªå™¨ï¼Œå†åˆ°è®©ä½ åœ¨ Chrome ä¸­åŒå‡»å•è¯å¹¶ç«‹å³äº†è§£å…¶å«ä¹‰çš„å­—å…¸ã€‚æ‚¨å¯ä»¥åœ¨ Chrome ç½‘ä¸Šåº”ç”¨åº—ä¸­æ‰¾åˆ°æ‰©å±•ç¨‹åºï¼Œå½“æ‚¨å®‰è£…ä¸€ä¸ªæ‰©å±•ç¨‹åºæ—¶ï¼Œå®ƒä¼šåœ¨ Chrome æµè§ˆå™¨çš„å³ä¸Šè§’æ˜¾ç¤ºä¸€ä¸ªå°å›¾æ ‡ã€‚

&emsp;&emsp;æ‰©å±•ç¨‹åºå¯ä»¥å¢åŠ æµè§ˆå™¨æœ¬èº«çš„åŠŸèƒ½ï¼Œä¹Ÿ**å¯ä»¥è°ƒç”¨æµè§ˆå™¨çš„ API**ï¼Œå¹¶ä¸”åŒä¸€ä¸ªæµè§ˆå™¨çš„æ‰©å±•ä¸€èˆ¬ä¹Ÿéƒ½æ˜¯å¯ä»¥**è·¨æ“ä½œç³»ç»Ÿ**ä½¿ç”¨çš„ã€‚æ¯”å¦‚ï¼Œä½ åœ¨ Windows ä½¿ç”¨çš„é‚£äº› Chrome æ‰©å±•ï¼Œæ¢åˆ° Mac å¹³å°ä¸Šä¹Ÿä¸€æ ·èƒ½ç”¨ã€‚

&emsp;&emsp;æ‰©å±•ä¸ºæµè§ˆå™¨æ·»åŠ ç‰¹æ€§ä¸åŠŸèƒ½ï¼Œå®ƒä¸€èˆ¬é€šè¿‡ web æŠ€æœ¯â€”â€”HTMLï¼ŒCSS è¿˜æœ‰ JavaScript æ¥åˆ›å»ºã€‚æ‰©å±•å…¶å®æ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼ŒFirefox çš„æ‰©å±•æ˜¯`.xpi`ã€Chrome æ‰©å±•æ ¼å¼ä¸º`.crx`ã€‚

### Chrome æ’ä»¶ï¼ˆChrome Pluginsï¼‰

&emsp;&emsp;æ’ä»¶æœ€å¥½è¢«æè¿°ä¸º**â€œæ’å…¥â€Chrome çš„ä»£ç åŒ…**ï¼Œå…è®¸ Web å¼€å‘äººå‘˜å°†æŸäº›åŠŸèƒ½ã€åŠ¨ç”»ã€è§†é¢‘ç­‰åµŒå…¥åˆ°ä»–ä»¬çš„ç½‘ç«™ä¸­ï¼Œæ’ä»¶**å¯è°ƒç”¨æ“ä½œç³»ç»Ÿçš„ API**ï¼Œå¹¶ä¸”ä¸åŒæ“ä½œç³»ç»Ÿçš„æ’ä»¶ä¸€èˆ¬ä¸èƒ½æ··ç”¨ï¼Œæ’ä»¶ä¸»è¦ç”¨äºå®ç°æµè§ˆå™¨æ— æ³•ç‹¬ç«‹å®ç°çš„åŠŸèƒ½ã€‚

&emsp;&emsp;ä¹Ÿå°±æ˜¯è¯´ï¼Œæ’ä»¶ä½¿å¾—åˆ«çš„ç¨‹åºæ‰èƒ½å¤„ç†çš„å†…å®¹åœ¨æµè§ˆå™¨çš„é¡µé¢ä¸­å¾—ä»¥å±•ç°å’Œå¤„ç†ã€‚æ‰€ä»¥æ’ä»¶ä¸€èˆ¬å®ç°çš„éƒ½æ˜¯æ¯”è¾ƒåº•å±‚çš„åŠŸèƒ½ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜ï¼Œå¾€å¾€å°±ä¼šç‰µæ¶‰åˆ°æ•´ä¸ªæ“ä½œç³»ç»Ÿï¼Œåƒ Flash æ’ä»¶å°±å±äºç»å¸¸è¢«æ‰’å‡ºé«˜å±æ¼æ´çš„é‚£ä¸€ç±»ã€‚åœ¨ Chrome 57 ç‰ˆæœ¬ä¹‹å‰ï¼Œä½ å¯ä»¥åœ¨åœ°å€æ ä¸­çš„`chrome://plugins`ä¸­æŸ¥çœ‹ Chrome çš„æ‰€æœ‰æ’ä»¶åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…æ‹¬ Adobâ€‹â€‹e Flash Playerã€Chrome PDF Viewer å’Œ Java æ’ä»¶ç­‰ï¼Œç°åœ¨`chrome://chrome-urls/`ä¸­å·²ç»æ‰¾ä¸åˆ°`chrome://plugins`äº†ã€‚

&emsp;&emsp;`chrome://plugins`ä¸å†å­˜åœ¨çš„éƒ¨åˆ†åŸå› æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒChrome ä¸å†æ”¯æŒ NPAPI æ’ä»¶â€”â€”ä¸€äº›æ’ä»¶ä¸å†å·¥ä½œï¼Œè€Œå…¶ä»–æ’ä»¶å·²ä»¥å„ç§æ–¹å¼é›†æˆåˆ° Chrome ä¸­ã€‚ä¾‹å¦‚ï¼ŒåŸºäº Java çš„å°ç¨‹åºä¸å†åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼ŒPDF æŸ¥çœ‹å™¨ç­‰åŠŸèƒ½å·²ç›´æ¥é›†æˆåˆ°æµè§ˆå™¨ä¸­ã€‚å› æ­¤ï¼Œæœ‰ç‚¹åƒåº”ç”¨ç¨‹åºï¼ˆChrome Appsï¼‰ï¼ŒChrome æ’ä»¶çš„ä¹Ÿæ­£åœ¨é€æ­¥æ·˜æ±°æˆ–é›†æˆåˆ°æµè§ˆå™¨çš„ä¸»ä½“ä¸­ã€‚

&emsp;&emsp;æ’ä»¶çš„æ ¼å¼é€šå¸¸æ˜¯**äºŒè¿›åˆ¶æ–‡ä»¶**ï¼Œå¦‚ windows ä¸‹çš„æ’ä»¶ä¸€èˆ¬æ˜¯`dll`ï¼Œlinux ä¸‹çš„æ’ä»¶ä¸€èˆ¬æ˜¯`os`æ ¼å¼ã€‚

&emsp;&emsp;ä»æœ¬è´¨ä¸Šè®²ï¼Œâ€œChrome åº”ç”¨ç¨‹åºâ€ä¼šè¢« PWA æ‰€æ›¿ä»£ï¼Œè€Œè¿™äº›å¹´æ¥æ’ä»¶åŸºæœ¬ä¸Šå·²è¢«å¼ƒç”¨ï¼Œæ‰€ä»¥ä½ åœ¨ Chrome ä¸­å”¯ä¸€éœ€è¦å…³å¿ƒçš„å°±æ˜¯æ‰©å±•ç¨‹åºã€‚

&emsp;&emsp;çœŸæ­£æ„ä¹‰ä¸Šçš„ Chrome æ’ä»¶æ˜¯æ›´åº•å±‚çš„æµè§ˆå™¨åŠŸèƒ½æ‰©å±•ï¼Œä½†æ˜¯æµè§ˆå™¨æ’ä»¶å’Œæ‰©å±•è¿™ä¸¤ä¸ªæ¦‚å¿µæ—©å·²è¢«æ··æ·†ã€‚é‰´äºå¤§éƒ¨åˆ†äººå¯¹ Chrome æ’ä»¶çš„å«æ³•å·²ç»ä¹ æƒ¯ï¼Œæœ¬æ–‡ä¹Ÿå…¨éƒ¨é‡‡ç”¨è¿™ç§å«æ³•ï¼Œä½†æ‚¨åº”è¯¥çŸ¥é“ï¼Œ**æœ¬æ–‡æ‰€æè¿°çš„ Chrome æ’ä»¶å®é™…ä¸ŠæŒ‡çš„æ˜¯ Chrome æ‰©å±•**ã€‚

> é¡ºä¾¿ç®€å•åšä¸ªè¡¥å……ï¼Œé™¤äº†ä»¥ä¸Šæåˆ°çš„ 3 ä¸ªæ¦‚å¿µï¼Œä½ å¯èƒ½è¿˜çœ‹åˆ°è¿‡`ActiveX`ï¼ˆæ§ä»¶ï¼‰ã€`Addon` ç­‰æ¦‚å¿µï¼Œå…¶å® `ActiveX` æ˜¯ IE å†…æ ¸æµè§ˆå™¨ä¸‹çš„æ’ä»¶ï¼ˆPluginï¼‰ï¼Œéšç€ IE æµè§ˆå™¨ä» Windows 11 ä¸­æ¶ˆå¤±ï¼Œå¹¶å°†åœ¨ 2022 å¹´æ­£å¼é€€å‡ºå†å²èˆå°ï¼Œæˆ‘ä»¬æ— éœ€è¿‡å¤šå…³æ³¨ï¼›Addon æ˜¯å±äº Mozilla ç³»æµè§ˆå™¨çš„ï¼Œä¸­æ–‡åå­—å«é™„åŠ ç»„ä»¶ï¼Œå…¶å®å’Œæµè§ˆå™¨æ‰©å±•æ˜¯åŒä¸€ç±»åº”ç”¨ã€‚

## æµè§ˆå™¨æ’ä»¶çš„æ ¸å¿ƒå…ƒç´ 

### `manifest.json`

&emsp;&emsp;ä¸€ä¸ª Chrome æ‰©å±•å…¶å®å°±æ˜¯ä¸€ä¸ªé…ç½®ï¼ˆå…¥å£ï¼‰æ–‡ä»¶ `manifest.json` å’Œä¸€ç³»åˆ— htmlã€cssã€jsã€å›¾ç‰‡æ–‡ä»¶çš„é›†åˆï¼Œæ‰©å±•/æ’ä»¶ä»å®ƒä»¬çš„`manifest.json`å¼€å§‹ï¼Œæ‰€ä»¥`manifest.json`æ˜¯ä¸€ä¸ª**Chrome æ’ä»¶æœ€é‡è¦ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„æ–‡ä»¶**ï¼Œç”¨æ¥é…ç½®æ‰€æœ‰å’Œæ’ä»¶ç›¸å…³çš„é…ç½®ï¼Œå¿…é¡»æ”¾åœ¨æ ¹ç›®å½•ã€‚ä¸€èˆ¬è‡³å°‘åº”è¯¥åŒ…å«ä¸‹é¢è¿™äº›é…ç½®ï¼š

```js
// manifest.json
{
  "name": "Getting Started Example", // æ‰©å±•çš„åç§°ï¼ˆnameï¼‰
  "version": "1.0", // æ’ä»¶ç‰ˆæœ¬å·
  "description": "Build an Extension!", // æ’ä»¶æè¿°
  "manifest_version": 2, // manifest ç‰ˆæœ¬ï¼Œç›®å‰æ˜¯å¿…é¡»æ˜¯2æˆ–è€…3

  // æŒ‡å®šæ‰©å±•åœ¨Chrome å·¥å…·æ ä¸­çš„å›¾æ ‡ï¼Œå®ƒå®šä¹‰äº†æ‰©å±•å›¾æ ‡æ–‡ä»¶ä½ç½®ï¼ˆdefault_iconï¼‰ã€
  // æ‚¬æµ®æç¤ºï¼ˆdefault_titleï¼‰å’Œç‚¹å‡»æ‰©å±•å›¾æ ‡æ‰€æ˜¾ç¤ºçš„é¡µé¢ä½ç½®ï¼ˆdefault_popupï¼‰
  "browser_action": {
    "default_title": "Hello, æŸSDN!",
    "default_icon": "/images/logo.png", // æµè§ˆå™¨å³ä¸Šè§’å›¾æ ‡è®¾ç½®
    "default_popup": "popup.html"
  }
}
```

> å½“ç„¶ï¼Œä¸€ä¸ª`manifest.json`æ–‡ä»¶å¯ä»¥åŒ…å«å¾ˆå¤šä¸œè¥¿ï¼Œå¯ä»¥å‚è€ƒ[Manifest file format](https://developer.chrome.com/docs/extensions/mv3/manifest/){:target='\_blank'}ï¼Œåç»­ä½¿ç”¨åˆ°å…¶ä»–é…ç½®ä¼šåœ¨æ³¨é‡Šä¸­è¿›è¡Œè¯´æ˜ã€‚

> VSCode åœ¨ä¹¦å†™`.json` æ–‡ä»¶çš„å¤‡æ³¨æ—¶æ ‡çº¢æç¤º `Comments are not permitted in JSON.ï¼ˆ521ï¼‰`ï¼Œæ­¤æ—¶åªéœ€ç‚¹å‡» VSCode ç•Œé¢å³ä¸‹è§’çš„â€œJSONâ€ï¼Œåœ¨é¡¶éƒ¨å±•ç°å‡ºçš„æ¡†ä¸­è¾“å…¥â€œJSON with Commentsâ€ï¼Œç‚¹å‡»ä½¿ç”¨å³å¯è§£å†³ã€‚

### `popup.html`

&emsp;&emsp;è¿™ä¸ªåç§°ä¸æ˜¯å›ºå®šçš„ï¼Œå–å†³äº `manifest.json`ä¸­å¯¹`browser_action`çš„â€œdefault_popupâ€å­—æ®µçš„é…ç½®ï¼Œå®ƒå®šä¹‰äº†ç‚¹å‡»æ’ä»¶çš„å›¾æ ‡æ‰€å±•ç¤ºçš„å¼¹çª—é¡µé¢ HTMLï¼Œ`popup.html`åƒæ™®é€š html ä¸€æ ·å¯ä»¥ç›´æ¥å¼•å…¥å…¶ä»– js æ–‡ä»¶ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™é‡Œé¢å¼•å…¥çš„ jsï¼Œå¦‚æœç›´æ¥æ“ä½œ DOMï¼Œæ“ä½œçš„æ˜¯ popup.html äº§ç”Ÿçš„ DOMï¼Œè€Œä¸æ˜¯æµè§ˆå™¨å½“å‰å±•ç¤ºé¡µé¢çš„ DOMã€‚

### `content_scripts`

&emsp;&emsp;è¿™ä¸€é¡¹æ¥è‡ªäº`manifest.json`çš„`content_scripts`é…ç½®é¡¹ï¼Œå£°æ˜äº†**éœ€è¦ç›´æ¥æ³¨å…¥é¡µé¢çš„ JSï¼Œè¿™é‡Œçš„ JS å¯ä»¥ç›´æ¥æ“ä½œå½“å‰é¡µé¢çš„ DOM å¯¹è±¡**ï¼Œæ‰€ä»¥è¿™ä¸ªæ–‡ä»¶åœ¨éœ€è¦å¯¹æ‰“å¼€çš„é¡µé¢è¿›è¡Œæ“ä½œæ—¶ä¼šå¾ˆæœ‰ç”¨ã€‚

## å¼€å‘è°ƒè¯•

&emsp;&emsp;**Chrome æ’ä»¶æ²¡æœ‰ä¸¥æ ¼çš„é¡¹ç›®ç»“æ„è¦æ±‚ï¼Œåªè¦ä¿è¯æ ¹ç›®å½•æœ‰ä¸€ä¸ª manifest.json å³å¯**ï¼Œä¹Ÿä¸éœ€è¦ä¸“é—¨çš„ IDE è¿›è¡Œå¼€å‘ã€‚

&emsp;&emsp;å¼€å‘è°ƒè¯•æ—¶ï¼Œè¿›å…¥æ’ä»¶ç®¡ç†é¡µé¢æœ€ç®€æ´çš„æ–¹å¼æ˜¯åœ¨åœ°å€æ è¾“å…¥`chrome://extensions/`è¿›è¡Œè®¿é—®ã€‚å…¶ä»–ä¸¤ç§è¿›å…¥æ’ä»¶ç®¡ç†é¡µé¢çš„æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![extensions](https://king-hcj.github.io/images/browser/dev_extensions1.png?raw=true)

![extensions](https://king-hcj.github.io/images/browser/dev_extensions2.png?raw=true)

&emsp;&emsp;æ‰“å¼€å³ä¸Šè§’**å¼€å‘è€…æ¨¡å¼**ä¾¿å¯ä»¥æ–‡ä»¶å¤¹çš„å½¢å¼ç›´æ¥åŠ è½½æ’ä»¶ï¼Œå¦åˆ™åªèƒ½å®‰è£…`.crx` æ ¼å¼çš„æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒChrome è¦æ±‚æ’ä»¶å¿…é¡»ä»å®ƒçš„ Chrome åº”ç”¨å•†åº—å®‰è£…ï¼Œå…¶å®ƒä»»ä½•ç½‘ç«™ä¸‹è½½çš„ä»¥åŠè‡ªå·±æ‰“åŒ…çš„éƒ½æ— æ³•ç›´æ¥å®‰è£…ã€‚æ‰€ä»¥ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥æŠŠ crx æ–‡ä»¶è§£å‹ï¼Œç„¶åé€šè¿‡å¼€å‘è€…æ¨¡å¼ç›´æ¥åŠ è½½ã€‚

![extensions](https://king-hcj.github.io/images/browser/dev_extensions3.png?raw=true)

&emsp;&emsp;å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä»£ç æœ‰ä»»ä½•æ”¹åŠ¨éƒ½å¿…é¡»é‡æ–°åŠ è½½æ’ä»¶ï¼Œç‚¹å‡»å¯¹åº”æ’ä»¶çš„é‡æ–°åŠ è½½æŒ‰é’®æˆ–è€…åˆ·æ–°å½“å‰æ’ä»¶ç®¡ç†é¡µé¢å‡å¯ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œå°†ä¼šå‡ºç°ç±»ä¼¼ä¸‹é¢çš„ç•Œé¢ï¼Œæ›´æ”¹åï¼Œä½ éœ€è¦å…ˆç‚¹å‡»â€œé”™è¯¯â€æŒ‰é’®è¿›å…¥å¼¹çª—å¯¹é”™è¯¯è¿›è¡Œæ¸…é™¤ã€‚

![extensions](https://king-hcj.github.io/images/browser/dev_extensions6.png?raw=true)

> å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„æ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒå®˜æ–¹[Debugging extensions](https://developer.chrome.com/docs/extensions/mv3/tut_debugging/){:target='\_blank'}æ–‡æ¡£ã€‚

## 3 åˆ†é’Ÿå†™ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ï¼Œè§£å†³æŸ SDN æœªç™»å½•æ— æ³•å¤åˆ¶ä»£ç çš„é—®é¢˜

&emsp;&emsp;æˆ‘ä»¬çŸ¥é“ï¼Œå‰æ®µæ—¶é—´æŸ SDN æ›´æ–°åï¼Œæœªç™»å½•æ—¶ï¼Œæ— æ³•å¤åˆ¶æ–‡ç« ä¸­çš„ä»£ç ï¼Œç»™å¼€å‘è€…å¸¦æ¥ä¸€å®šä¸ä¾¿ã€‚ä»Šå¤©æˆ‘ä»¬å°±èŠ± 3 åˆ†é’Ÿæ—¶é—´å†™ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ï¼Œçªç ´è¿™ç§é™åˆ¶ã€‚

&emsp;&emsp;åŸºæœ¬æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œ**é€šè¿‡å°†å½“å‰é¡µé¢çš„`document.body.contentEditable`å€¼è®¾ç½®ä¸º`true`æ¥è¾¾åˆ°å¯å¤åˆ¶çš„æ•ˆæœ**ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæˆ‘ä»¬é€šè¿‡æ§åˆ¶å°é¢æ¿æˆ–è€…â€œè‡ªå®šä¹‰ä¹¦ç­¾â€œçš„æ–¹å¼ä¹Ÿèƒ½è½»æ¾å®ç°ï¼Œè¿™é‡Œåªæ˜¯è®©å¤§å®¶ä½“éªŒä¸€ä¸‹ç®€å•æ’ä»¶çš„å¼€å‘ï¼Œé¿å…å‡ºæ‰‹å°±æ˜¯â€Hello Worldï¼â€œï¼ŒğŸ˜„

> ä¹¦ç­¾åŠŸèƒ½çš„å®ç°å¯å‚è€ƒ[å‰ç«¯è£…é€¼æŠ€å·§ 108 å¼ï¼ˆä¸€ï¼‰â€”â€” æ‰“å·¥äºº](https://juejin.cn/post/6996850474175430686#heading-3){:target='\_blank'}ã€‚

&emsp;&emsp;ä¸‹é¢å°†é€æ­¥ä»‹ç»é¡¹ç›®å„æ–‡ä»¶ç›¸å…³ä¿¡æ¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»[è¿™é‡Œ](https://stackblitz.com/edit/browser-extension?){:target='\_blank'}åœ¨çº¿æŸ¥çœ‹å®Œæ•´ä»£ç ã€‚æ•´ä¸ªé¡¹ç›®**æ ¸å¿ƒä»£ç ä¸è¶³ 30 è¡Œ**ï¼Œç›¸ä¿¡æ‚¨èƒ½è—‰æ­¤è¿…é€Ÿå…¥é—¨ Chrome æ’ä»¶å¼€å‘ï¼Œæ¿€å‘å…´è¶£å’Œæ½œèƒ½ï¼Œå†™å‡ºæ›´æœ‰ç”¨çš„æ’ä»¶æˆ–è€…åº”ç”¨ã€‚

### ç›®å½•ç»“æ„

- manifest.jsonï¼šé…ç½®æ–‡ä»¶ï¼Œæ’ä»¶å¼€å‘ä¸­çš„å¿…å¤‡é¡¹ï¼›
- popup.htmlï¼šæ’ä»¶å¼¹çª—ï¼›
- style.cssï¼šå¼¹çª—æ ·å¼æ–‡ä»¶ï¼›
- js
  - popup.jsï¼šå¼¹çª— popup.html ä¸­ä½¿ç”¨çš„ jsï¼›
  - content_script.jsï¼šéœ€è¦ç›´æ¥æ³¨å…¥é¡µé¢çš„ jsï¼›
- images
  - logo.pngï¼šæ’ä»¶å›¾æ ‡ã€‚

### manifest.json é…ç½®æ–‡ä»¶

```js
{
  // æ¸…å•æ–‡ä»¶çš„ç‰ˆæœ¬ï¼Œå¿…é¡»æ˜¯2æˆ–è€…3ï¼Œ
  // æ–‡æ¡£è§ https://developer.chrome.com/docs/extensions/mv3/manifest/manifest_version/
  "manifest_version": 2,
  // æ’ä»¶çš„åç§°
  "name": "Copy SDN",
  // æ’ä»¶çš„ç‰ˆæœ¬
  "version": "1.0.0",
  // æ’ä»¶æè¿°
  "description": "ä¸ç™»å½•ä¾ç„¶å¯ä»¥åœ¨æŸSDNé¡µé¢è¿›è¡Œä»£ç å¤åˆ¶ï¼",
  // æŒ‡å®šæ‰©å±•åœ¨Chrome å·¥å…·æ ä¸­çš„å›¾æ ‡ï¼Œå®ƒå®šä¹‰äº†æ‰©å±•å›¾æ ‡æ–‡ä»¶ä½ç½®ï¼ˆdefault_iconï¼‰ã€
  // æ‚¬æµ®æç¤ºï¼ˆdefault_titleï¼‰å’Œç‚¹å‡»æ‰©å±•å›¾æ ‡æ‰€æ˜¾ç¤ºçš„é¡µé¢ä½ç½®ï¼ˆdefault_popupï¼‰
  "browser_action": {
    "default_title": "Hello, æŸSDN!",
    "default_icon": "/images/logo.png", // æµè§ˆå™¨å³ä¸Šè§’å›¾æ ‡è®¾ç½®
    "default_popup": "popup.html"
  },
  // https://developer.chrome.com/docs/extensions/mv2/manifest/icons/
  // 128x128 çš„å›¾æ ‡ï¼›å®ƒåœ¨å®‰è£…æœŸé—´å’Œ Chrome ç½‘ä¸Šåº”ç”¨åº—ä½¿ç”¨
  // 48x48 å›¾æ ‡ï¼Œç”¨äºæ‰©å±•ç¨‹åºç®¡ç†é¡µé¢ (chrome://extensions)
  // 16x16 å›¾æ ‡ç”¨ä½œæ‰©å±•é¡µé¢çš„æ”¶è—å¤¹å›¾æ ‡
  // è¿™é‡Œåªå†™ä¸€ä¸ªå…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„
  "icons": {
    "128": "/images/logo.png"
  },
  // éœ€è¦ç›´æ¥æ³¨å…¥é¡µé¢çš„JS
  "content_scripts": [
    {
      //"matches": ["http://*/*", "https://*/*"],"<all_urls>" è¡¨ç¤ºåŒ¹é…æ‰€æœ‰åœ°å€
      "matches": ["https://blog.csdn.net/*"],
      // å¤šä¸ªJSæŒ‰é¡ºåºæ³¨å…¥
      "js": ["/js/content_script.js"],
      // "css": ["css/custom.css"],
      // ä»£ç æ³¨å…¥çš„æ—¶é—´ï¼Œå¯é€‰å€¼ï¼š "document_start", "document_end", or "document_idle"ï¼Œ
      // document_idleè¡¨ç¤ºé¡µé¢ç©ºé—²æ—¶ï¼Œä¸ºé»˜è®¤å€¼
      "run_at": "document_start"
    }
  ],
  // å®šä¹‰äº†æ‰©å±•éœ€è¦å‘ Chrome ç”³è¯·çš„æƒé™ï¼Œæ¯”å¦‚é€šè¿‡ XMLHttpRequest è·¨åŸŸè¯·æ±‚æ•°æ®ã€è®¿é—®æµè§ˆå™¨é€‰é¡¹å¡ï¼ˆtabsï¼‰
  // è·å–å½“å‰æ´»åŠ¨é€‰é¡¹å¡ï¼ˆactiveTabï¼‰ã€æµè§ˆå™¨é€šçŸ¥ï¼ˆnotificationsï¼‰ã€å­˜å‚¨ï¼ˆstorageï¼‰ç­‰ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ã€‚
  "permissions": ["tabs"]
}
```

### popup.html å’Œ css åˆ¶ä½œæ’ä»¶å¼¹çª—

`popup.html`ï¼š

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <title>Copy SDN</title>
  </head>

  <body>
    å…è®¸å¤åˆ¶Codeï¼š<input type="checkbox" class="switch" id="toggle" />
    <!-- è¿™é‡Œå¼•å…¥äº†popup.jsï¼Œæ¥ç»™popupå¼¹çª—æ·»åŠ ä¸€äº›äº¤äº’åŠŸèƒ½ -->
    <script src="./js/popup.js"></script>
  </body>
</html>
```

å¼¹çª—æ ·å¼æ–‡ä»¶`style.css`ï¼š

```css
body {
  width: 160px;
  height: 24px;
  background-color: lavender;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* Switchå¼€å…³æ ·å¼ */
input[type='checkbox'].switch {
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  position: relative;
  width: 40px;
  height: 20px;
  background: #ccc;
  border-radius: 10px;
  transition: border-color 0.3s, background-color 0.3s;
}

input[type='checkbox'].switch::after {
  content: '';
  display: inline-block;
  width: 1rem;
  height: 1rem;
  border-radius: 50%;
  background: #fff;
  box-shadow: 0, 0, 2px, #999;
  transition: 0.4s;
  top: 2px;
  position: absolute;
  left: 2px;
}

input[type='checkbox'].switch:checked {
  background: rgb(19, 206, 102);
}

/* å½“input[type=checkbox]è¢«é€‰ä¸­æ—¶ï¼šä¼ªå…ƒç´ æ˜¾ç¤ºä¸‹é¢æ ·å¼ ä½ç½®å‘ç”Ÿå˜åŒ– */
input[type='checkbox'].switch:checked::after {
  content: '';
  position: absolute;
  left: 55%;
  top: 2px;
}
```

&emsp;&emsp;ä»¥ä¸Šä»£ç å°†æ„å»ºå‡ºå¦‚ä¸‹æ’ä»¶å¼¹çª— UIï¼š

![extensions](https://king-hcj.github.io/images/browser/copy_sdn.png?raw=true)

### popup.js ç»™å¼¹çª—æ·»åŠ äº¤äº’

```js
// è¿™é‡Œçš„jså…¶å®æ˜¯æ“ä½œpopup.htmläº§ç”Ÿçš„domçš„
document.addEventListener('DOMContentLoaded', function () {
  // è·å–å¼€å…³æŒ‰é’®çš„åˆå§‹å€¼ã€‚è¿™é‡Œ{ type: 'get_editable' }æ˜¯å¯ä»¥éšæ„å®šä¹‰çš„ï¼Œå¯ä»¥ä¼ é€’ä»»ä½•ä½ æƒ³ä¼ é€’çš„ä¿¡æ¯
  sendMessageToContentScript({ type: 'get_editable' }, (response) => {
    toggle.checked = ['true', true].includes(response) ? 'checked' : null;
  });

  // åˆ‡æ¢contentEditableçŠ¶æ€
  toggle.addEventListener('change', () => {
    sendMessageToContentScript({ type: 'toggle' });
  });
});

// å‘content_scriptså‘é€æ¶ˆæ¯çš„å‡½æ•°
function sendMessageToContentScript(message, callback) {
  // è¿™é‡Œç”¨åˆ°äº†tabsï¼Œæ‰€ä»¥å‰é¢é…ç½®æ–‡ä»¶éœ€è¦é…ç½®"permissions": ["tabs"]
  chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {
    chrome.tabs.sendMessage(tabs[0].id, message, (response) => {
      if (callback) callback(response);
    });
  });
}
```

### content_script.js å‘é¡µé¢æ³¨å…¥ JS

```js
// æ‰€è°“content-scriptsï¼Œå…¶å®å°±æ˜¯Chromeæ’ä»¶ä¸­å‘é¡µé¢æ³¨å…¥è„šæœ¬çš„ä¸€ç§å½¢å¼ï¼ˆè™½ç„¶åä¸ºscriptï¼Œå…¶å®è¿˜å¯ä»¥åŒ…æ‹¬cssï¼‰ï¼Œ
// å€ŸåŠ©content-scriptsæˆ‘ä»¬å¯ä»¥å®ç°é€šè¿‡é…ç½®çš„æ–¹å¼è½»æ¾å‘æŒ‡å®šé¡µé¢æ³¨å…¥JSå’ŒCSSï¼ˆå¦‚æœéœ€è¦åŠ¨æ€æ³¨å…¥ï¼Œå¯ä»¥å‚è€ƒä¸‹æ–‡ï¼‰ï¼Œ
// æœ€å¸¸è§çš„æ¯”å¦‚ï¼šå¹¿å‘Šå±è”½ã€é¡µé¢CSSå®šåˆ¶ï¼Œç­‰ç­‰ã€‚

// æ¥æ”¶æ¶ˆæ¯
chrome.runtime.onMessage.addListener(function (request, sender, sendResponse) {
  // æ•°æ®å¤„ç†å’Œè¿”å›ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹ç±»ä¼¼reduxä¸­reduceræ•°æ®å¤„ç†çš„æ„Ÿè§‰
  switch (request.type) {
    case 'get_editable':
      // å°†å½“å‰æ–‡æ¡£æ˜¯å¦å¯ç¼–è¾‘çš„ä¿¡æ¯è¿”å›ç»™popupï¼Œæ§åˆ¶å¼€å…³çš„å½¢æ€
      sendResponse(document.body.contentEditable);
      break;
    case 'toggle':
      // åˆ‡æ¢å¯ç¼–è¾‘çŠ¶æ€
      document.body.contentEditable = ![true, 'true'].includes(
        document.body.contentEditable
      );
    default:
      break;
  }
});
```

## æ‰“åŒ…ä¸å‘å¸ƒ

&emsp;&emsp;åœ¨æ’ä»¶ç®¡ç†é¡µå·¦ä¸Šè§’æœ‰ä¸€ä¸ªâ€œæ‰“åŒ…æ‰©å±•ç¨‹åºâ€çš„æŒ‰é’®ï¼Œç‚¹å‡»å°±ä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œé€‰æ‹©è¦æ‰“åŒ…çš„æ–‡ä»¶å¤¹è¿›è¡Œæ‰“åŒ…å³å¯ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª`.crx`çš„å‹ç¼©æ–‡ä»¶ï¼Œè¿™ä¸ªå®é™…ä¸Šå°±æ˜¯ä½ ç»å¸¸å®‰è£…æ’ä»¶æ—¶å®‰è£…çš„å‹ç¼©åŒ…æ–‡ä»¶ã€‚

![extensions](https://king-hcj.github.io/images/browser/dev_extensions4.png?raw=true)
![extensions](https://king-hcj.github.io/images/browser/dev_extensions5.png?raw=true)

&emsp;&emsp;è¦å‘å¸ƒåˆ° Google åº”ç”¨å•†åº—çš„è¯ï¼Œéœ€è¦å…ˆæ”¯ä»˜ 5 ç¾å…ƒçš„æ³¨å†Œè´¹æˆä¸ºå¼€å‘è€…ï¼š[Register as a Chrome Web Store Developer](https://chrome.google.com/webstore/devconsole/register){:target='\_blank'}ã€‚

![extensions](https://king-hcj.github.io/images/browser/dev_extensions7.png?raw=true)

## å‚è€ƒèµ„æ–™

- [How to Build & Publish a Chrome Extension in 13 Minutes?ğŸ”¥](https://www.youtube.com/watch?v=gtF2nHVjqFk){:target='\_blank'}
- [Chrome Apps, Plugins, Extensions: Whatâ€™s the Difference?](https://www.maketecheasier.com/chrome-apps-plugins-extensions-differences/){:target='\_blank'}
- [ã€å¹²è´§ã€‘Chrome æ’ä»¶(æ‰©å±•)å¼€å‘å…¨æ”»ç•¥](http://blog.haoji.me/chrome-plugin-develop.html){:target='\_blank'}
